(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{106:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0),a=r.n(n);function i(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement("strong",null,"Result: "),a.a.createElement("pre",{className:"graphql-result"},JSON.stringify(e.result,null,2)))}},84:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return g})),r.d(t,"metadata",(function(){return v})),r.d(t,"rightToc",(function(){return O})),r.d(t,"default",(function(){return w}));var n=r(2),a=r(6),i=(r(0),r(91)),o=r(106),l={data:{movies:[{title:"Spirited Away",year:"2001"},{title:"Shrek",year:"2001"}]}},s=["components"],c={rightToc:[]};function p(e){var t=e.components,r=Object(a.a)(e,s);return Object(i.b)("wrapper",Object(n.a)({},c,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),'import { createWrapper, WrapperFor } from "graphql-mocks/resolver";\n\nfunction filterResult(result, args) {\n  // only filter on results that are arrays of objects, ie: [User!]!\n  if (\n    !Array.isArray(result) ||\n    (Array.isArray(result) && result.some((item) => typeof item !== "object"))\n  ) {\n    return result;\n  }\n\n  const filtered = result.filter((resultItem) => {\n    // ensure that the value for an argument matches the value\n    // on the object for the matching key\n    return Object.entries(args).every(([key, value]) => {\n      if (key in resultItem) {\n        return resultItem[key] === value;\n      }\n\n      return true;\n    });\n  });\n\n  return filtered;\n}\n\nexport const automaticFilterWrapper = createWrapper(\n  "automatic-field-filtering",\n  WrapperFor.FIELD,\n  async function (originalResolver, wrapperOptions) {\n    return async (parent, args, context, info) => {\n      const result = await originalResolver(parent, args, context, info);\n      return filterResult(result, args);\n    };\n  }\n);\n')))}p.isMDXComponent=!0;var u=["components"],m={rightToc:[]};function d(e){var t=e.components,r=Object(a.a)(e,u);return Object(i.b)("wrapper",Object(n.a)({},m,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),'export const movies = [\n  {\n    title: "Spirited Away",\n    year: "2001",\n  },\n\n  {\n    title: "Shrek",\n    year: "2001",\n  },\n\n  {\n    title: "La La Land",\n    year: "2016",\n  },\n];\n')))}d.isMDXComponent=!0;var f=["components"],b={rightToc:[]};function y(e){var t=e.components,r=Object(a.a)(e,f);return Object(i.b)("wrapper",Object(n.a)({},b,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),'import { GraphQLHandler } from "graphql-mocks";\nimport { embed } from "graphql-mocks/resolver-map";\nimport { automaticFilterWrapper } from "./automatic-filtering-filter.source";\nimport { resolverMap } from "./resolver-map";\n\nconst handler = new GraphQLHandler({\n  resolverMap,\n  middlewares: [\n    embed({\n      wrappers: [automaticFilterWrapper],\n    }),\n  ],\n\n  dependencies: {\n    graphqlSchema: `\n      schema {\n        query: Query\n      }\n\n      type Query {\n        movies(title: String, year: String): [Movie!]!\n      }\n\n      type Movie {\n        title: String!\n        year: String!\n      }\n    `,\n  },\n});\n\nconst query = handler.query(\n  `\n  query FilteredMovies($year: String) {\n    movies(year: $year) {\n      title\n      year\n    }\n  }\n`,\n  {\n    year: "2001",\n  }\n);\nquery.then((result) => console.log(result));\n')))}y.isMDXComponent=!0;var h=["components"],g={title:"Automatic Filtering with Wrappers"},v={unversionedId:"guides/automatic-filtering",id:"guides/automatic-filtering",isDocsHomePage:!1,title:"Automatic Filtering with Wrappers",description:"A common pattern is to filter information on Field Resolvers based on arguments from a query. In the case this pattern can be applied to multiple Field Resolvers it's useful to standardize this filtering with Resolver Wrappers. This helps separate filtering from the data resolution and allows for re-use. The nature of the filtering depends on the conventions of your GraphQL API.",source:"@site/docs/guides/automatic-filtering.mdx",slug:"/guides/automatic-filtering",permalink:"/docs/guides/automatic-filtering",version:"current",sidebar:"docs",previous:{title:"Create Custom Highlighters",permalink:"/docs/highlight/creating-highlighters"},next:{title:"Relay Pagination",permalink:"/docs/guides/relay-pagination"}},O=[{value:"Example",id:"example",children:[]}],j={rightToc:O};function w(e){var t=e.components,r=Object(a.a)(e,h);return Object(i.b)("wrapper",Object(n.a)({},j,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"A common pattern is to filter information on Field Resolvers based on arguments from a query. In the case this pattern can be applied to multiple Field Resolvers it's useful to standardize this filtering with ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/resolver/introducing-wrappers"}),"Resolver Wrappers"),". This helps separate filtering from the data resolution and allows for re-use. The nature of the filtering depends on the conventions of your GraphQL API."),Object(i.b)("h2",{id:"example"},"Example"),Object(i.b)("p",null,"This Resolver Wrapper is an example of automatically filtering a list based on the arguments passed in. If a given key is provided it will filter any list down based on the value of the argument."),Object(i.b)(p,{mdxType:"AutomaticFilterSource"}),Object(i.b)("p",null,"For this example the ",Object(i.b)("inlineCode",{parentName:"p"},"Query.movies")," resolver has the following data:"),Object(i.b)(d,{mdxType:"AutomaticFilterData"}),Object(i.b)("p",null,"Then setting up the handler to apply the ",Object(i.b)("inlineCode",{parentName:"p"},"automaticFilter")," Wrapper against the ",Object(i.b)("inlineCode",{parentName:"p"},"Query.movies"),"\nfield resolver. The ",Object(i.b)("inlineCode",{parentName:"p"},"highlight")," argument can be customized to specify a specific selection of fields that should receive the automatic filter wrapper. Also, because there can be multiple Resolver Wrappers passed into the ",Object(i.b)("inlineCode",{parentName:"p"},"wrappers")," array, you could crete and combine multiple automatic filtering Field Wrappers to flexibly compose filtering across your fields."),Object(i.b)("p",null,"The final query in the example, ",Object(i.b)("inlineCode",{parentName:"p"},"FilteredMovies"),", will automatically filter based on the query args ",Object(i.b)("inlineCode",{parentName:"p"},'{ "year": "2001" }')," since ",Object(i.b)("inlineCode",{parentName:"p"},"year")," is an argument that also exists on the ",Object(i.b)("inlineCode",{parentName:"p"},"Movie")," type being filtered."),Object(i.b)(y,{mdxType:"AutomaticFilterExample"}),Object(i.b)(o.a,{result:l,mdxType:"GraphQLResult"}),Object(i.b)("p",null,'In the result the movie "La La Land" was filtered out since it was released in 2016 and the query specified movies with the year ',Object(i.b)("inlineCode",{parentName:"p"},"'2001'"),"."))}w.isMDXComponent=!0},91:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return f}));var n=r(0),a=r.n(n);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=a.a.createContext({}),p=function(e){var t=a.a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},u=function(e){var t=p(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),d=n,f=u["".concat(o,".").concat(d)]||u[d]||m[d]||i;return r?a.a.createElement(f,l(l({ref:t},c),{},{components:r})):a.a.createElement(f,l({ref:t},c))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var c=2;c<i;c++)o[c]=r[c];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,r)}d.displayName="MDXCreateElement"}}]);