(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{126:function(e,t,n){"use strict";n.r(t),n.d(t,"MDXContext",(function(){return s})),n.d(t,"MDXProvider",(function(){return d})),n.d(t,"mdx",(function(){return f})),n.d(t,"useMDXComponents",(function(){return l})),n.d(t,"withMDXComponents",(function(){return u}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),u=function(e){return function(t){var n=l(t.components);return r.a.createElement(e,i({},t,{components:n}))}},l=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},d=function(e){var t=l(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},O=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=m(e,["components","mdxType","originalType","parentName"]),s=l(n),u=a,d=s["".concat(i,".").concat(u)]||s[u]||b[u]||o;return n?r.a.createElement(d,p(p({ref:t},c),{},{components:n})):r.a.createElement(d,p({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=O;var c={};for(var p in t)hasOwnProperty.call(t,p)&&(c[p]=t[p]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var m=2;m<o;m++)i[m]=n[m];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}O.displayName="MDXCreateElement"},58:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return s}));var a=n(2),r=n(7),o=(n(0),n(126)),i={id:"operations",title:"Operations"},c={unversionedId:"paper/operations",id:"paper/operations",isDocsHomePage:!1,title:"Operations",description:"Operations are functions available within an Mutate Transaction callback with access to internal context including the current mutable version of the DocumentStore being operated on.",source:"@site/docs/paper/operations.md",slug:"/paper/operations",permalink:"/docs/paper/operations",version:"current",sidebar:"docs",previous:{title:"Mutating Data",permalink:"/docs/paper/mutating-data"},next:{title:"Events",permalink:"/docs/paper/events"}},p=[{value:"Base Operations",id:"base-operations",children:[]},{value:"Operational Context",id:"operational-context",children:[]},{value:"Creating Custom Operations",id:"creating-custom-operations",children:[]}],m={rightToc:p};function s(e){var t=e.components,n=Object(r.default)(e,["components"]);return Object(o.mdx)("wrapper",Object(a.default)({},m,n,{components:t,mdxType:"MDXLayout"}),Object(o.mdx)("p",null,"Operations are functions available within an ",Object(o.mdx)("em",{parentName:"p"},"Mutate Transaction")," callback with access to internal context including the current ",Object(o.mdx)("strong",{parentName:"p"},"mutable")," version of the ",Object(o.mdx)("inlineCode",{parentName:"p"},"DocumentStore")," being operated on."),Object(o.mdx)("h2",{id:"base-operations"},"Base Operations"),Object(o.mdx)("p",null,"The ones that are provided by GraphQL Paper out-of-the-box are ",Object(o.mdx)("inlineCode",{parentName:"p"},"create"),", ",Object(o.mdx)("inlineCode",{parentName:"p"},"find"),", ",Object(o.mdx)("inlineCode",{parentName:"p"},"remove"),", ",Object(o.mdx)("inlineCode",{parentName:"p"},"clone"),", ",Object(o.mdx)("inlineCode",{parentName:"p"},"getStore"),", ",Object(o.mdx)("inlineCode",{parentName:"p"},"queueEvent"),". These are covered in ",Object(o.mdx)("a",Object(a.default)({parentName:"p"},{href:"/docs/paper/mutating-data#transaction-operations"}),Object(o.mdx)("em",{parentName:"a"},"Mutating Data")),"."),Object(o.mdx)("h2",{id:"operational-context"},"Operational Context"),Object(o.mdx)("p",null,"What makes Operations different than regular functions is that the first argument is bound (via ",Object(o.mdx)("inlineCode",{parentName:"p"},".bind"),") at the beginning of every transaction, for each operation, with ",Object(o.mdx)("a",Object(a.default)({parentName:"p"},{href:"pathname:///api/paper/modules/types.html#OperationContext"}),Object(o.mdx)("inlineCode",{parentName:"a"},"Operation Context")),"."),Object(o.mdx)("p",null,"The shape of the Operation Context is:"),Object(o.mdx)("pre",null,Object(o.mdx)("code",Object(a.default)({parentName:"pre"},{}),"{\n  store: DocumentStore\n  schema: GraphQLSchema\n  eventQueue: Event[]\n}\n")),Object(o.mdx)("ul",null,Object(o.mdx)("li",{parentName:"ul"},Object(o.mdx)("inlineCode",{parentName:"li"},"store")," is the current ",Object(o.mdx)("strong",{parentName:"li"},"mutable")," version of the store available during the transaction"),Object(o.mdx)("li",{parentName:"ul"},Object(o.mdx)("inlineCode",{parentName:"li"},"schema")," is an instance of ",Object(o.mdx)("inlineCode",{parentName:"li"},"GraphQLSchema")," based on the schema passed into ",Object(o.mdx)("inlineCode",{parentName:"li"},"Paper")),Object(o.mdx)("li",{parentName:"ul"},Object(o.mdx)("inlineCode",{parentName:"li"},"eventQueue")," is an array of events that will be emitted at the end of the transaction")),Object(o.mdx)("h2",{id:"creating-custom-operations"},"Creating Custom Operations"),Object(o.mdx)("p",null,"Additional ",Object(o.mdx)("em",{parentName:"p"},"Operations")," can be added to be used within the ",Object(o.mdx)("em",{parentName:"p"},"Mutate Transaction")," callback.\nThe first argument is reserved and ",Object(o.mdx)("em",{parentName:"p"},"must")," be the ",Object(o.mdx)("inlineCode",{parentName:"p"},"context")," object even if it's not used for the custom operation. What is provided by the ",Object(o.mdx)("inlineCode",{parentName:"p"},"OperationContext")," argument is ",Object(o.mdx)("a",Object(a.default)({parentName:"p"},{href:"#operational-context"}),"described above"),"."),Object(o.mdx)("pre",null,Object(o.mdx)("code",Object(a.default)({parentName:"pre"},{className:"language-js"}),"export const customOperation = (context, argOne, argTwo) => {\n  /* custom logic for your custom operation */\n};\n")),Object(o.mdx)("p",null,"If using typescript, import the ",Object(o.mdx)("inlineCode",{parentName:"p"},"OperationContext")," for the first argument of the function. Setting up your Operation this way should allow the types and autocomplete to work within the the ",Object(o.mdx)("em",{parentName:"p"},"Mutate Transaction")," callback."),Object(o.mdx)("pre",null,Object(o.mdx)("code",Object(a.default)({parentName:"pre"},{className:"language-typescript"}),"// customOperation.ts\nimport { OperationContext }  from 'graphql-paper/types';\n\nexport const customOperation = (context: OperationContext, argOne: string, argTwo: number) => {\n  /* custom logic for your custom operation */\n  return /* return anything useful as a result of the operation */;\n};\n")),Object(o.mdx)("p",null,"Operations can be added to the ",Object(o.mdx)("inlineCode",{parentName:"p"},"Paper")," constructor's second argument configuration object, on the ",Object(o.mdx)("inlineCode",{parentName:"p"},"operations")," key."),Object(o.mdx)("pre",null,Object(o.mdx)("code",Object(a.default)({parentName:"pre"},{className:"language-js"}),"import { customOperation } from './customOperation';\nimport { graphqlSchema } from './schema';\n\nconst operations = { custom: customOperation };\nconst paper = new Paper(graphqlSchema, { operations });\n")),Object(o.mdx)("pre",null,Object(o.mdx)("code",Object(a.default)({parentName:"pre"},{className:"language-typescript"}),"import { customOperation } from './customOperation';\nimport { graphqlSchema } from './schema';\n\nconst operations = { custom: customOperation };\nconst paper = new Paper(graphqlSchema, { operations });\n")),Object(o.mdx)("p",null,"The key provided in the ",Object(o.mdx)("inlineCode",{parentName:"p"},"OperationMap")," hash is what is made available by destructuring within the ",Object(o.mdx)("em",{parentName:"p"},"Mutate Transaction")," callback."),Object(o.mdx)("pre",null,Object(o.mdx)("code",Object(a.default)({parentName:"pre"},{className:"language-js"}),"paper.mutate(({ custom }) => {\n  const result = custom('argOne magic!', 42);\n});\n")))}s.isMDXComponent=!0}}]);