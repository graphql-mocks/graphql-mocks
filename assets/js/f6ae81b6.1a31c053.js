"use strict";(self.webpackChunk_graphql_mocks_docs=self.webpackChunk_graphql_mocks_docs||[]).push([[2886],{5141:function(e,n,a){a.d(n,{u:function(){return t}});var r=a(2784);function t(e){return r.createElement(r.Fragment,null,r.createElement("strong",null,"Result: "),r.createElement("pre",{className:"graphql-result"},JSON.stringify(e.result,null,2)))}},70692:function(e,n,a){a.r(n),a.d(n,{assets:function(){return g},contentTitle:function(){return u},default:function(){return v},frontMatter:function(){return h},metadata:function(){return m},toc:function(){return f}});var r=a(28427),t=a(84397),l=(a(2784),a(30876)),o=["components"],i={toc:[]};function p(e){var n=e.components,a=(0,t.Z)(e,o);return(0,l.kt)("wrapper",(0,r.Z)({},i,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'import { GraphQLHandler } from "graphql-mocks";\n\nconst schemaString = `\n  schema {\n    query: Query\n  }\n\n  type Query {\n    helloWorld: String!\n  }\n`;\n\nconst resolverMap = {\n  Query: {\n    helloWorld() {\n      return "Hello from my first GraphQL resolver!";\n    },\n  },\n};\n\nconst handler = new GraphQLHandler({\n  resolverMap,\n  dependencies: {\n    graphqlSchema: schemaString,\n  },\n});\n\nconst query = handler.query(\n  `\n    {\n      helloWorld\n    }\n  `\n);\nquery.then((result) => console.log(result));\n')))}p.isMDXComponent=!0;var s={data:{helloWorld:"Hello from my first GraphQL resolver!"}},d=a(5141),c=["components"],h={id:"introducing-handler",title:"Introducing the GraphQL Handler"},u=void 0,m={unversionedId:"handler/introducing-handler",id:"handler/introducing-handler",title:"Introducing the GraphQL Handler",description:"Ultimately, in order to be able to execute GraphQL queries you need a GraphQL handler. This handler accepts a query and variables and returns a payload of data and/or errors.",source:"@site/docs/handler/introducing-handler.md",sourceDirName:"handler",slug:"/handler/introducing-handler",permalink:"/docs/handler/introducing-handler",draft:!1,tags:[],version:"current",frontMatter:{id:"introducing-handler",title:"Introducing the GraphQL Handler"},sidebar:"docs",previous:{title:"Quick Example",permalink:"/docs/getting-started/quick-example"},next:{title:"Using Middlewares",permalink:"/docs/handler/using-middlewares"}},g={},f=[{value:"Installation",id:"installation",level:2},{value:"Getting started",id:"getting-started",level:2},{value:"Using the CLI",id:"using-the-cli",level:3},{value:"GraphQL Schema",id:"graphql-schema",level:3},{value:"Using the CLI",id:"using-the-cli-1",level:4},{value:"Dependencies",id:"dependencies",level:3},{value:"Resolver Map",id:"resolver-map",level:3},{value:"Querying",id:"querying",level:2},{value:"Example",id:"example",level:2}],k={toc:f};function v(e){var n=e.components,a=(0,t.Z)(e,c);return(0,l.kt)("wrapper",(0,r.Z)({},k,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Ultimately, in order to be able to execute GraphQL queries you need a GraphQL handler. This handler accepts a query and variables and returns a payload of data and/or errors."),(0,l.kt)("p",null,"The GraphQL Handler is also the glue between many pieces of the mocking framework, like Resolver Maps, Resolver Map Middlewares, Resolver Wrappers and Network Handlers, which are covered in the following sections."),(0,l.kt)("h2",{id:"installation"},"Installation"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# npm\nnpm install --save-dev graphql-mocks\n\n# yarn\nyarn add --dev graphql-mocks\n")),(0,l.kt)("p",null,"Double-check that you've installed the ",(0,l.kt)("inlineCode",{parentName:"p"},"graphql-mocks")," package also."),(0,l.kt)("h2",{id:"getting-started"},"Getting started"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"GraphQLHandler")," is available from the core ",(0,l.kt)("inlineCode",{parentName:"p"},"graphql-mocks")," package."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"import { GraphQLHandler } from 'graphql-mocks';\nimport schema from './schema';\n\nconst handler = new GraphQLHandler({\n  dependencies: {\n    graphqlSchema: schema\n  }\n});\n")),(0,l.kt)("h3",{id:"using-the-cli"},"Using the CLI"),(0,l.kt)("p",null,"To speed the process of creating a GraphQL Handler the ",(0,l.kt)("inlineCode",{parentName:"p"},"gqlmocks")," cli can be used:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"npx gqlmocks handler generate\n")),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"/docs/cli/commands#gqlmocks-handler-generate"},"CLI docs")," for more information."),(0,l.kt)("h3",{id:"graphql-schema"},"GraphQL Schema"),(0,l.kt)("p",null,"A GraphQL Schema is a required dependency for setting up the handler."),(0,l.kt)("p",null,"The schema can be:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"an instance of ",(0,l.kt)("inlineCode",{parentName:"li"},"GraphQLSchema")," provided by the ",(0,l.kt)("inlineCode",{parentName:"li"},"graphql")," package"),(0,l.kt)("li",{parentName:"ul"},"a GraphQL Schema AST (sometimes what is provided by babel loaders or bundlers)"),(0,l.kt)("li",{parentName:"ul"},"a string that is formatted in GraphQL SDL (Schema Definition Language)")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const handler = new GraphQLHandler({\n  dependencies: {\n    graphqlSchema: schema,\n\n    // include other dependencies by key,\n    // like a `Paper` instance of graphql-paper store, for example.\n    paper: Paper\n  }\n});\n")),(0,l.kt)("h4",{id:"using-the-cli-1"},"Using the CLI"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"gqlmocks")," cli can be used to fetch, validate and print info about a GraphQL Schemas. The ",(0,l.kt)("inlineCode",{parentName:"p"},"fetch")," command is particularly useful to download a GraphQL Schema locally from either a remote GraphQL API or a url to an ",(0,l.kt)("inlineCode",{parentName:"p"},".gql"),"/",(0,l.kt)("inlineCode",{parentName:"p"},".graphql")," file formatted in the SDL (Schema Definition Language) where the file can be downloaded from."),(0,l.kt)("p",null,"For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'npx gqlmocks fetch --source "http://remote-gql-api.com"\n')),(0,l.kt)("p",null,"To see the available ",(0,l.kt)("inlineCode",{parentName:"p"},"gqlmocks")," schema commands check out the ",(0,l.kt)("a",{parentName:"p",href:"/docs/cli/commands#gqlmocks-schema-fetch"},"CLI documentation"),"."),(0,l.kt)("h3",{id:"dependencies"},"Dependencies"),(0,l.kt)("p",null,"As stated above some form of a GraphQL Schema is a required dependency for the ",(0,l.kt)("inlineCode",{parentName:"p"},"GraphQLHandler"),". Aside from this, other Resolver Map Middlewares, Resolver Wrappers, or Resolvers may require their own dependencies. These can be listed on the ",(0,l.kt)("inlineCode",{parentName:"p"},"dependencies")," object passed into the ",(0,l.kt)("inlineCode",{parentName:"p"},"GraphQLHandler"),"."),(0,l.kt)("p",null,"These dependencies can also be accessed from the context within a Resolver (see ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/managing-context#dependencies"},"Managing Resolver Context")," for more information)."),(0,l.kt)("h3",{id:"resolver-map"},"Resolver Map"),(0,l.kt)("p",null,"A base Resolver Map can be ",(0,l.kt)("em",{parentName:"p"},"optionally")," included with the GraphQL Handler. It can then be used for subsequent Resolver Map Middlewares."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const resolverMap = {};\n\nconst handler = new GraphQLHandler({\n  resolverMap: resolverMap,\n\n  dependencies: {\n    graphqlSchema: schema\n  }\n});\n")),(0,l.kt)("p",null,"See ",(0,l.kt)("a",{parentName:"p",href:"/docs/resolver-map/using-resolver-maps"},"Using Resolver Maps")," to learn more about Resolver Maps, and ",(0,l.kt)("a",{parentName:"p",href:"/docs/resolver-map/introducing-middlewares"},"Introducing Resolver Map Middlewares")," on how they can be extended with Middlewares."),(0,l.kt)("h2",{id:"querying"},"Querying"),(0,l.kt)("p",null,"Calling the ",(0,l.kt)("inlineCode",{parentName:"p"},"query")," method (with queries or mutations) on a ",(0,l.kt)("inlineCode",{parentName:"p"},"GraphQLHandler")," will return a promise with a payload (",(0,l.kt)("inlineCode",{parentName:"p"},"data")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"errors"),"). The first argument of ",(0,l.kt)("inlineCode",{parentName:"p"},"query")," method takes a string representing the operation (a query or mutation). The second argument is an object representing the variables used for the query."),(0,l.kt)("p",null,"Learn more about queries and mutations from the ",(0,l.kt)("a",{parentName:"p",href:"https://graphql.org/learn/queries/"},"official GraphQL Documentation")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Note:")," The variable names in the object must match the the names at the top of the operation without the ",(0,l.kt)("inlineCode",{parentName:"p"},"$"),". In the following example the ",(0,l.kt)("inlineCode",{parentName:"p"},"$name")," variable passed in at the top of the query has a matching ",(0,l.kt)("inlineCode",{parentName:"p"},"name")," property in the ",(0,l.kt)("inlineCode",{parentName:"p"},"variables")," object."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Note:")," Additional context can be passed on a per-query basis, see ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/managing-context"},"Managing Resolver Context")," for details."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const query = `\n  query($name: String!) {\n    hello(name: $name)\n  }\n`;\n\nconst variables = {\n  name: 'Simone'\n};\n\n// handler as an instance of GraphQLHandler\nconst result = await handler.query(query, variables);\n")),(0,l.kt)("h2",{id:"example"},"Example"),(0,l.kt)("p",null,"This example follows the most basic path of creating custom resolvers that many GraphQL tutorials follow. While this shows the handler in use keep in mind that the ",(0,l.kt)("inlineCode",{parentName:"p"},"GraphQLHandler")," is also used with Middlewares and Wrappers to flexibly cover many different use-cases and scenarios."),(0,l.kt)(p,{mdxType:"CreateHandlerExample"}),(0,l.kt)(d.u,{result:s,mdxType:"GraphQLResult"}))}v.isMDXComponent=!0},30876:function(e,n,a){a.d(n,{Zo:function(){return d},kt:function(){return u}});var r=a(2784);function t(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function l(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?l(Object(a),!0).forEach((function(n){t(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,r,t=function(e,n){if(null==e)return{};var a,r,t={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],n.indexOf(a)>=0||(t[a]=e[a]);return t}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var p=r.createContext({}),s=function(e){var n=r.useContext(p),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},d=function(e){var n=s(e.components);return r.createElement(p.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var a=e.components,t=e.mdxType,l=e.originalType,p=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),h=s(a),u=t,m=h["".concat(p,".").concat(u)]||h[u]||c[u]||l;return a?r.createElement(m,o(o({ref:n},d),{},{components:a})):r.createElement(m,o({ref:n},d))}));function u(e,n){var a=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var l=a.length,o=new Array(l);o[0]=h;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i.mdxType="string"==typeof e?e:t,o[1]=i;for(var s=2;s<l;s++)o[s]=a[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"}}]);