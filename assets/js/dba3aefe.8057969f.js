"use strict";(self.webpackChunk_graphql_mocks_docs=self.webpackChunk_graphql_mocks_docs||[]).push([[8030],{5141:function(e,n,t){t.d(n,{u:function(){return a}});var r=t(2784);function a(e){return r.createElement(r.Fragment,null,r.createElement("strong",null,"Result: "),r.createElement("pre",{className:"graphql-result"},JSON.stringify(e.result,null,2)))}},15875:function(e,n,t){t.r(n),t.d(n,{assets:function(){return b},contentTitle:function(){return w},default:function(){return N},frontMatter:function(){return v},metadata:function(){return q},toc:function(){return x}});var r=t(28427),a=t(84397),i=(t(2784),t(30876)),o=t(5141),p=["components"],l={toc:[]};function s(e){var n=e.components,t=(0,a.Z)(e,p);return(0,i.kt)("wrapper",(0,r.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'import schemaString from "./schema";\n\nimport { Paper } from "graphql-paper";\nimport { graphql, buildSchema } from "graphql";\n\nasync function run() {\n  const graphqlSchema = buildSchema(schemaString);\n  const paper = new Paper(graphqlSchema);\n\n  await paper.mutate(({ create }) => {\n    create("Film", {\n      id: "1",\n      title: "Jurassic Park",\n      year: "1993",\n      actors: [\n        { id: "1", name: "Jeff Goldblum" },\n        { id: "2", name: "Wayne Knight" },\n      ],\n    });\n\n    create("Film", {\n      id: "2",\n      title: "Office Space",\n      year: "1999",\n      actors: [\n        { id: "3", name: "Ron Livingston" },\n        { id: "4", name: "Jennifer Aniston" },\n      ],\n    });\n  });\n\n  const queryType = graphqlSchema.getQueryType();\n  const queryTypeFields = queryType.getFields();\n\n  queryTypeFields.films.resolve = function filmsResolver(\n    root,\n    args,\n    context,\n    info\n  ) {\n    // return all `Film` Documents\n    return paper.data.Film;\n  };\n\n  queryTypeFields.film.resolve = function filmResolver(\n    root,\n    args,\n    context,\n    info\n  ) {\n    return paper.data.Film.find((film) => film.id === args.filmId) ?? null;\n  };\n\n  const query = `\n    query {\n      film(filmId: "1") {\n        id\n        title\n        year\n        actors {\n          id\n          name\n        }\n      }\n\n      films {\n        id\n        title\n        year\n\n        # will return the connected Actor documents automatically\n        actors {\n          id\n          name\n        }\n      }\n    }\n  `;\n\n  const result = await graphql({\n    source: query,\n    schema: graphqlSchema,\n  });\n\n  console.log(result);\n}\n\n// kick everything off!\nrun();\n')))}s.isMDXComponent=!0;var u={data:{film:{actors:[{id:"1",name:"Jeff Goldblum"},{id:"2",name:"Wayne Knight"}],id:"1",title:"Jurassic Park",year:"1993"},films:[{id:"1",title:"Jurassic Park",year:"1993",actors:[{id:"1",name:"Jeff Goldblum"},{id:"2",name:"Wayne Knight"}]},{id:"2",title:"Office Space",year:"1999",actors:[{id:"3",name:"Ron Livingston"},{id:"4",name:"Jennifer Aniston"}]}]}},m=["components"],c={toc:[]};function d(e){var n=e.components,t=(0,a.Z)(e,m);return(0,i.kt)("wrapper",(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const graphqlSchema = `\n  schema {\n    query: Query\n    mutation: Mutation\n  }\n\n  type Query {\n    films: [Film!]!\n    film(filmId: ID!): Film\n  }\n\n  type Mutation {\n    addFilm(input: AddFilmInput!): Film!\n  }\n\n  type Film {\n    id: ID!\n    title: String!\n    year: String!\n    actors: [Actor!]!\n  }\n\n  type Actor {\n    id: ID!\n    name: String!\n  }\n\n  input AddFilmInput {\n    title: String!\n    year: String!\n    actors: [AddFilmActorInput!]!\n  }\n\n  input AddFilmActorInput {\n    name: String!\n  }\n`;\n\n// kick everything off\nexport default graphqlSchema;\n")))}d.isMDXComponent=!0;var h=["components"],g={toc:[]};function f(e){var n=e.components,t=(0,a.Z)(e,h);return(0,i.kt)("wrapper",(0,r.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'import schemaString from "./schema";\n\nimport { Paper } from "graphql-paper";\nimport { graphql, buildSchema } from "graphql";\n\nasync function run() {\n  const graphqlSchema = buildSchema(schemaString);\n  const paper = new Paper(graphqlSchema);\n\n  const mutationType = graphqlSchema.getMutationType();\n  const mutationTypeFields = mutationType.getFields();\n\n  mutationTypeFields.addFilm.resolve = function filmsResolver(\n    root,\n    args,\n    context,\n    info\n  ) {\n    return paper.mutate(({ create, getStore }) => {\n      const store = getStore();\n      const maxIdReducer = (previous, { id }) =>\n        Math.max(Number(previous), Number(id)).toString();\n      let lastFilmId = store.Film.reduce(maxIdReducer, "0");\n      let lastActorId = store.Actor.reduce(maxIdReducer, "0");\n\n      const newFilm = create("Film", {\n        id: ++lastFilmId,\n        title: args.input.title,\n        year: args.input.year,\n      });\n\n      newFilm.actors = args.input.actors.map((actor) => {\n        return create("Actor", {\n          id: ++lastActorId,\n          ...actor,\n        });\n      });\n\n      return newFilm;\n    });\n  };\n\n  const mutation = `\n    mutation($addFilmInput: AddFilmInput!) {\n      addFilm(input: $addFilmInput) {\n        id\n        title\n        year\n        actors {\n          id\n          name\n        }\n      }\n    }\n  `;\n\n  const mutationInput = {\n    title: "My Girl",\n    year: "1991",\n    actors: [{ name: "Anna Chlumsky" }],\n  };\n\n  const result = await graphql({\n    source: mutation,\n    schema: graphqlSchema,\n    variableValues: { addFilmInput: mutationInput },\n  });\n\n  console.log(result);\n}\n\n// kick everything off!\nrun();\n')))}f.isMDXComponent=!0;var y={data:{addFilm:{actors:[{id:"1",name:"Anna Chlumsky"}],id:"1",title:"My Girl",year:"1991"}}},k=["components"],v={id:"with-graphql",title:"Using GraphQL Paper with GraphQL"},w=void 0,q={unversionedId:"paper/guides/with-graphql",id:"paper/guides/with-graphql",title:"Using GraphQL Paper with GraphQL",description:"GraphQL Paper is built on the core graphql library and works well with its default resolvers. GraphQL Paper should also work well with other javascript systems that use resolver functions, too. The best integrations will still be with graphql-mocks and its packages which are designed and tested together.",source:"@site/docs/paper/guides/with-graphql.md",sourceDirName:"paper/guides",slug:"/paper/guides/with-graphql",permalink:"/docs/paper/guides/with-graphql",draft:!1,tags:[],version:"current",frontMatter:{id:"with-graphql",title:"Using GraphQL Paper with GraphQL"},sidebar:"docs",previous:{title:"Generating Data with Factories",permalink:"/docs/paper/guides/factories"},next:{title:"Managing IDs",permalink:"/docs/paper/guides/managing-ids"}},b={},x=[{value:"Example",id:"example",level:2},{value:"Schema",id:"schema",level:3},{value:"Querying",id:"querying",level:3},{value:"Complete Query Example",id:"complete-query-example",level:4},{value:"Mutating",id:"mutating",level:3},{value:"Returning from Mutations",id:"returning-from-mutations",level:4},{value:"Complete Mutation Example",id:"complete-mutation-example",level:4}],T={toc:x};function N(e){var n=e.components,t=(0,a.Z)(e,k);return(0,i.kt)("wrapper",(0,r.Z)({},T,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"GraphQL Paper is built on the core ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/graphql/graphql-js"},(0,i.kt)("inlineCode",{parentName:"a"},"graphql")," library")," and works well with its default resolvers. GraphQL Paper should also work well with other javascript systems that use resolver functions, too. The best integrations will still be with ",(0,i.kt)("inlineCode",{parentName:"p"},"graphql-mocks")," and its packages which are designed and tested together."),(0,i.kt)("p",null,"If using GraphQL Paper with ",(0,i.kt)("inlineCode",{parentName:"p"},"graphql-mocks")," check out the ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/paper"},"guide")," dedicated to setup, common patterns and techniques."),(0,i.kt)("h2",{id:"example"},"Example"),(0,i.kt)("p",null,"Here is an example of GraphQL Paper working with the core ",(0,i.kt)("inlineCode",{parentName:"p"},"graphql")," package"),(0,i.kt)("h3",{id:"schema"},"Schema"),(0,i.kt)("p",null,"The full ",(0,i.kt)("em",{parentName:"p"},"Querying")," and ",(0,i.kt)("em",{parentName:"p"},"Mutating")," examples below make use of the following schema:"),(0,i.kt)(d,{mdxType:"ExampleSchema"}),(0,i.kt)("h3",{id:"querying"},"Querying"),(0,i.kt)("p",null,"To resolve queries in a GraphQL Resolver return data from the ",(0,i.kt)("inlineCode",{parentName:"p"},"paper.data")," property on a ",(0,i.kt)("inlineCode",{parentName:"p"},"Paper")," instance. The ",(0,i.kt)("a",{parentName:"p",href:"/docs/paper/querying-data"},(0,i.kt)("em",{parentName:"a"},"GraphQL Paper Querying Data documentation"))," provides more information on how to retrieve data with GraphQL Paper."),(0,i.kt)("p",null,"GraphQL Paper also provides connections between different types and their corresponding documents out of the box which allows for the resolution of resolvers to work recursively. To kick off this behavior ",(0,i.kt)("em",{parentName:"p"},"return")," the appropriate Document or list of Documents from the top-level ",(0,i.kt)("inlineCode",{parentName:"p"},"Query")," resolvers."),(0,i.kt)("h4",{id:"complete-query-example"},"Complete Query Example"),(0,i.kt)("p",null,"In this example returning the resolvers for a list of ",(0,i.kt)("inlineCode",{parentName:"p"},"[Film!]")," from the ",(0,i.kt)("inlineCode",{parentName:"p"},"Query.films")," or a single ",(0,i.kt)("inlineCode",{parentName:"p"},"Film")," by ID from ",(0,i.kt)("inlineCode",{parentName:"p"},"Query.film")," will also satisify any queries that request a film's ",(0,i.kt)("inlineCode",{parentName:"p"},"Actor"),"s by returning the ",(0,i.kt)("inlineCode",{parentName:"p"},"actors")," connections on the ",(0,i.kt)("inlineCode",{parentName:"p"},"Film")," document."),(0,i.kt)("p",null,"Using the ",(0,i.kt)("inlineCode",{parentName:"p"},"graphql")," npm package with the above schema for an end-to-end example involving queries."),(0,i.kt)(s,{mdxType:"QueryExample"}),(0,i.kt)(o.u,{result:u,mdxType:"GraphQLResult"}),(0,i.kt)("h3",{id:"mutating"},"Mutating"),(0,i.kt)("p",null,"Mutations also work with GraphQL Paper and ",(0,i.kt)("inlineCode",{parentName:"p"},"graphql"),". The ",(0,i.kt)("a",{parentName:"p",href:"/docs/paper/mutating-data"},(0,i.kt)("em",{parentName:"a"},"GraphQL Paper Mutating Data documentation"))," provides more information on how mutating data with GraphQL Paper."),(0,i.kt)("h4",{id:"returning-from-mutations"},"Returning from Mutations"),(0,i.kt)("p",null,"If a document can satisfy a mutation's expected return type then return it from ",(0,i.kt)("inlineCode",{parentName:"p"},"paper.mutate"),". In this example if the mutation field returns a GraphQL Type of ",(0,i.kt)("inlineCode",{parentName:"p"},"SomeType")," then"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"async function createSomeTypeMutationResolver(root, args, context, info) {\n  // return the paper.mutate\n  return paper.mutate(({ create }) => {\n    // return the created SomeType Paper Document\n    return create('SomeType', { /* use data from args... */ });\n  });\n}\n")),(0,i.kt)("p",null,"If the result is not satisfied by the document the result can be awaited and modified as needed. Assuming in this example the mutation payload only required the payload with the ID"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"{ someTypeId: newId }\n")),(0,i.kt)("p",null,"Then the mutation resolver could look like:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"async function createSomeTypeMutationResolver(root, args, context, info) {\n  // return the paper.mutate\n  const someTypeDocument = await paper.mutate(({ create }) => {\n    // return the created SomeType Paper Document\n    return create('SomeType', { /* use data from args... */ });\n  });\n\n  // take the resulting document and returning the required shape\n  return {\n    someTypeId: someTypeDocument.id\n  };\n}\n")),(0,i.kt)("h4",{id:"complete-mutation-example"},"Complete Mutation Example"),(0,i.kt)("p",null,"Using the ",(0,i.kt)("inlineCode",{parentName:"p"},"graphql")," npm package with the above schema for an end-to-end example using mutations."),(0,i.kt)(f,{mdxType:"MutationExample"}),(0,i.kt)(o.u,{result:y,mdxType:"GraphQLResult"}))}N.isMDXComponent=!0},30876:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return d}});var r=t(2784);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),s=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=s(e.components);return r.createElement(l.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),c=s(t),d=a,h=c["".concat(l,".").concat(d)]||c[d]||m[d]||i;return t?r.createElement(h,o(o({ref:n},u),{},{components:t})):r.createElement(h,o({ref:n},u))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=c;var p={};for(var l in n)hasOwnProperty.call(n,l)&&(p[l]=n[l]);p.originalType=e,p.mdxType="string"==typeof e?e:a,o[1]=p;for(var s=2;s<i;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"}}]);